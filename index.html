<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Night Delivery Ma≈Çdyty</title>

<meta name="theme-color" content="#000000">
<link rel="manifest" href="manifest.json">

<style>
:root{--yellow:#f5c400;--black:#000;--dark:#111;}
body{margin:0;font-family:Arial,sans-serif;background:#000;color:#fff;}
.banner{height:160px;display:flex;justify-content:center;align-items:center;
background:radial-gradient(circle at top, rgba(245,196,0,.25), transparent 65%);}
.banner img{max-width:320px;width:80%;}
header{text-align:center;padding:20px;}
h1{color:var(--yellow);margin:5px 0;}
.sub{opacity:.8;}
.phone{color:var(--yellow);text-decoration:none;font-size:18px;display:block;margin-top:8px;}
.rating{margin-top:6px;font-size:14px;opacity:.8;}
.card{background:#111;border-radius:18px;padding:20px;margin:15px;}
label{font-size:14px;opacity:.8;}
input,select,textarea{width:100%;margin-top:6px;padding:12px;border-radius:12px;
border:none;background:#000;color:#fff;}
button.main{margin-top:15px;width:100%;padding:14px;border:none;border-radius:14px;
background:var(--yellow);font-weight:bold;font-size:16px;}
.stars span{font-size:26px;cursor:pointer;color:#444;}
.stars span.active{color:var(--yellow);}
.opinia{font-size:13px;border-bottom:1px solid #222;padding:8px 0;}
footer{text-align:center;padding:20px;opacity:.7;}
</style>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
apiKey: "TU_WKLEJ_APIKEY",
authDomain: "TU_WKLEJ_DOMAIN",
projectId: "TU_WKLEJ_PROJECT_ID",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.saveOpinionFB = async (stars, text) => {
await addDoc(collection(db,"opinions"),{ stars, text, time:Date.now() });
};

window.listenOpinions = (cb) => {
onSnapshot(collection(db,"opinions"), snap=>{
const arr=[];
snap.forEach(d=>arr.push(d.data()));
cb(arr);
});
};
</script>
</head>

<body>

<div class="banner"><img src="logo.png"></div>

<header>
<h1>Night Delivery Ma≈Çdyty</h1>
<div class="sub">Dostawa & przew√≥z 24/7</div>
<a class="phone" href="tel:+48512956568">üìû +48 512 956 568</a>
<div class="rating" id="avgRating">‚≠ê 0.0 / 5 (0 opinii)</div>
</header>

<div class="card">
<label>Rodzaj us≈Çugi</label>
<select id="type">
<option>Dostawa</option>
<option>Przew√≥z</option>
</select>

<label>Dystans (km)</label>
<input type="number" id="km">
<button class="main" onclick="getGPS()">üìç Oblicz km z GPS</button>

<label>Adres / opis</label>
<textarea id="note"></textarea>

<label>Napiwek</label>
<input type="number" id="tip">

<label>P≈Çatno≈õƒá</label>
<select id="payment">
<option>Got√≥wka</option>
<option>BLIK 603433325</option>
</select>

<button class="main" onclick="calculate()">Oblicz cenƒô</button>
<div id="price" style="text-align:center;color:var(--yellow);font-size:22px"></div>

<button class="main" onclick="sendOrder()">üì© Zam√≥w</button>
</div>

<div class="card">
<label>Oce≈Ñ aplikacjƒô</label>
<div class="stars" id="stars"></div>
<textarea id="opinionText"></textarea>
<button class="main" onclick="saveOpinion()">Dodaj opiniƒô</button>
</div>

<div class="card">
<h3>Opinie</h3>
<div id="opinions"></div>
</div>

<footer>üìû 512 956 568</footer>

<script>
const kmInput = document.getElementById("km");
const tipInput = document.getElementById("tip");
const priceDiv = document.getElementById("price");

/* GPS */
const MALDYTY={lat:53.9586,lon:19.7406};
function getGPS(){
navigator.geolocation.getCurrentPosition(pos=>{
const km=distance(MALDYTY.lat,MALDYTY.lon,pos.coords.latitude,pos.coords.longitude);
kmInput.value=km.toFixed(1);
});
}
function distance(a,b,c,d){
const R=6371;
const dLat=(c-a)*Math.PI/180;
const dLon=(d-b)*Math.PI/180;
const x=Math.sin(dLat/2)**2+
Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(dLon/2)**2;
return R*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));
}

/* CENA */
function calculate(){
const km=parseFloat(kmInput.value);
const tip=parseFloat(tipInput.value)||0;
if(!km)return alert("Podaj km");
const night=new Date().getHours()>=22||new Date().getHours()<6;
let price=night?19+km*1.6:15+km*1.4;
price+=tip;
priceDiv.innerText="Cena: "+price.toFixed(2)+" z≈Ç";
}

/* ZAM√ìWIENIE */
function sendOrder(){
if(!priceDiv.innerText)return alert("Oblicz cenƒô");
const txt=`Night Delivery Ma≈Çdyty
Us≈Çuga:${type.value}
Km:${kmInput.value}
${priceDiv.innerText}
P≈Çatno≈õƒá:${payment.value}
Uwagi:${note.value}`;
window.open("https://wa.me/48512956568?text="+encodeURIComponent(txt));
}

/* ====== OPINIE ‚Äì POPRAWIONE ====== */
let sel = 0;
const starsDiv = document.getElementById("stars");

for(let i=1;i<=5;i++){
const s=document.createElement("span");
s.innerText="‚òÖ";
s.onclick=()=>{
sel = i;
[...starsDiv.children].forEach((e,j)=>{
e.classList.toggle("active", j < sel);
});
};
starsDiv.appendChild(s);
}

function saveOpinion(){
if(sel <= 0){
alert("Wybierz gwiazdki");
return;
}
saveOpinionFB(sel, opinionText.value);
opinionText.value="";
sel = 0;
[...starsDiv.children].forEach(e=>e.classList.remove("active"));
}

listenOpinions(arr=>{
opinions.innerHTML="";
let sum=0;
arr.forEach(o=>{
sum+=o.stars;
opinions.innerHTML+=`<div class="opinia">‚≠ê ${o.stars} ${o.text||""}</div>`;
});
avgRating.innerText=`‚≠ê ${(arr.length?sum/arr.length:0).toFixed(1)} / 5 (${arr.length})`;
});
</script>

</body>
</html>









<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Night Delivery Ma≈Çdyty</title>

<meta name="theme-color" content="#000000">
<link rel="manifest" href="manifest.json">

<style>
:root{--yellow:#f5c400;}
body{margin:0;font-family:Arial,sans-serif;background:#000;color:#fff;}
.banner{height:160px;display:flex;justify-content:center;align-items:center;
background:radial-gradient(circle at top, rgba(245,196,0,.25), transparent 65%);}
.banner img{max-width:320px;width:80%;}
header{text-align:center;padding:20px;}
h1{color:var(--yellow);}
.phone{color:var(--yellow);text-decoration:none;font-size:18px;}
.card{background:#111;border-radius:18px;padding:20px;margin:15px;}
input,select,textarea{width:100%;margin-top:6px;padding:12px;border-radius:12px;
border:none;background:#000;color:#fff;}
button.main{margin-top:15px;width:100%;padding:14px;border:none;border-radius:14px;
background:var(--yellow);font-weight:bold;font-size:16px;}
.stars span{font-size:28px;cursor:pointer;color:#444;}
.stars span.active{color:var(--yellow);}
.opinia{font-size:13px;border-bottom:1px solid #222;padding:8px 0;}
.reg-box{border:2px solid #f5c400;border-radius:14px;padding:14px;font-size:13px;}
footer{text-align:center;padding:20px;opacity:.7;}
</style>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyDqWK9pZt5Ak97-1b12LymEu5bGVLpbPn0",
authDomain: ""night-delivery-18960.firebaseapp.com",
projectId: "night-delivery-18960",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.saveOpinionFB = async (stars, text) => {
await addDoc(collection(db,"opinions"),{
stars,
text,
time: Date.now()
});
};

window.listenOpinions = (cb) => {
const q = query(collection(db,"opinions"), orderBy("time","desc"));
onSnapshot(q, snap=>{
const arr=[];
snap.forEach(d=>arr.push(d.data()));
cb(arr);
});
};
</script>
</head>

<body>

<div class="banner"><img src="logo.png"></div>

<header>
<h1>Night Delivery Ma≈Çdyty</h1>
<a class="phone" href="tel:+48512956568">üìû 512 956 568</a>
<div id="avgRating">‚≠ê 0.0 / 5 (0 opinii)</div>
</header>

<div class="card">
<label>Oce≈Ñ aplikacjƒô</label>
<div class="stars" id="stars"></div>
<textarea id="opinionText" placeholder="Napisz opiniƒô (opcjonalnie)"></textarea>
<button class="main" id="addOpinionBtn">Dodaj opiniƒô</button>
</div>

<div class="card">
<h3>Opinie</h3>
<div id="opinions"></div>
</div>

<footer>Night Delivery Ma≈Çdyty</footer>

<script>
const starsDiv = document.getElementById("stars");
const opinionText = document.getElementById("opinionText");
const opinionsDiv = document.getElementById("opinions");
const avgRating = document.getElementById("avgRating");
const addBtn = document.getElementById("addOpinionBtn");

let selectedStars = 0;

/* GWIAZDKI */
for(let i=1;i<=5;i++){
const s=document.createElement("span");
s.textContent="‚òÖ";
s.onclick=()=>{
selectedStars=i;
[...starsDiv.children].forEach((el,idx)=>{
el.classList.toggle("active",idx<i);
});
};
starsDiv.appendChild(s);
}

/* ZAPIS OPINII */
addBtn.onclick = async () => {
if(selectedStars === 0){
alert("Wybierz gwiazdki");
return;
}
addBtn.disabled = true;
await window.saveOpinionFB(selectedStars, opinionText.value.trim());
opinionText.value="";
selectedStars=0;
[...starsDiv.children].forEach(e=>e.classList.remove("active"));
addBtn.disabled=false;
};

/* ODCZYT OPINII */
window.listenOpinions(arr=>{
opinionsDiv.innerHTML="";
let sum=0;
arr.forEach(o=>{
sum+=o.stars;
opinionsDiv.innerHTML+=
`<div class="opinia">‚≠ê ${o.stars} ${o.text||""}</div>`;
});
avgRating.innerText =
`‚≠ê ${(arr.length?sum/arr.length:0).toFixed(1)} / 5 (${arr.length} opinii)`;
});
</script>

</body>
</html>


